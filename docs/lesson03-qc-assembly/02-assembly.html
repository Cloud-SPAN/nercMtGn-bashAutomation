<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Automating Metagenomics Analyses with Bash Scripts - Metagenome Assembly</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../docs/lesson04-polishing/index.html" rel="next">
<link href="../../docs/lesson03-qc-assembly/01-QC-quality-raw-reads.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/cloud-span-icon.png" alt="Cloud-SPAN logo." class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lessons" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lessons</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lessons">    
        <li>
    <a class="dropdown-item" href="../../index.html">
 <span class="dropdown-text">Course Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/lesson01-files-and-directories/index.html">
 <span class="dropdown-text">Files and Directories</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/lesson02-using-the-command-line/index.html">
 <span class="dropdown-text">Using the Command Line</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/lesson03-qc-assembly/index.html">
 <span class="dropdown-text">QC &amp; Assembly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/lesson04-polishing/index.html">
 <span class="dropdown-text">Polishing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/lesson05-binning-functional-annotation/index.html">
 <span class="dropdown-text">Binning and Functional Annotation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/lesson06-taxonomic-annotations/index.html">
 <span class="dropdown-text">Taxonomic Annotations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/lesson07-automation-bash-scripts/index.html">
 <span class="dropdown-text">Automating Analyses with Bash Scripts</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../docs/miscellanea/setup.html"> 
<span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extras" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Extras</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-extras">    
        <li>
    <a class="dropdown-item" href="../../docs/miscellanea/reference.qmd">
 <span class="dropdown-text">Reference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/miscellanea/about.html">
 <span class="dropdown-text">About</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/miscellanea/data.qmd">
 <span class="dropdown-text">Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/miscellanea/faq.qmd">
 <span class="dropdown-text">Frequently Asked Questions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/miscellanea/instructornotes.qmd">
 <span class="dropdown-text">Instructor Notes</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../docs/miscellanea/license.html"> 
<span class="menu-text">License</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../docs/miscellanea/codeofconduct.html"> 
<span class="menu-text">Code of Conduct</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/lesson03-qc-assembly/index.html">QC &amp; Assembly</a></li><li class="breadcrumb-item"><a href="../../docs/lesson03-qc-assembly/02-assembly.html">Metagenome Assembly</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/lesson01-files-and-directories/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Files and Directories</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson01-files-and-directories/01-understanding-file-systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Understanding your file system</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson01-files-and-directories/02-logging-onto-cloud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logging onto the Cloud</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson01-files-and-directories/03-shell-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introducing the Shell</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/lesson02-using-the-command-line/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using the Command Line</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson02-using-the-command-line/01-navigating-file-directories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Navigating Files and Directories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson02-using-the-command-line/02-working-with-file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Files and Directories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson02-using-the-command-line/03-redirection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Redirection</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/lesson03-qc-assembly/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">QC &amp; Assembly</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson03-qc-assembly/00-introduction-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Metagenomics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson03-qc-assembly/01-QC-quality-raw-reads.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assessing Read Quality, Trimming and Filtering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson03-qc-assembly/02-assembly.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Metagenome Assembly</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/lesson04-polishing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polishing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson04-polishing/01-polishing-assembly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Polishing an assembly</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson04-polishing/02-QC-polished-assembly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">QC polished assembly</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/lesson05-binning-functional-annotation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binning &amp; Functional Annotation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson05-binning-functional-annotation/01-binning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metagenome Binning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson05-binning-functional-annotation/02-binning_quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">QC of metagenome bins</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson05-binning-functional-annotation/03-Functional-annotation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Functional annotation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/lesson06-taxonomic-annotations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taxonomic Annotations</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson06-taxonomic-annotations/01-taxonomic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taxonomic Assignment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson06-taxonomic-annotations/02-Diversity-tackled-with-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diversity Tackled With R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson06-taxonomic-annotations/03-hands_on-diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Taxonomic Analysis with R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/lesson07-automation-bash-scripts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automating Analyses with Bash Scripts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson07-automation-bash-scripts/01-scripting-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Bash Scripting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/lesson07-automation-bash-scripts/02-base-automation-script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base Automation Script</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#assembling-reads" id="toc-assembling-reads" class="nav-link active" data-scroll-target="#assembling-reads">Assembling reads</a>
  <ul class="collapse">
  <li><a href="#genomic-assembly" id="toc-genomic-assembly" class="nav-link" data-scroll-target="#genomic-assembly">Genomic assembly</a></li>
  <li><a href="#metagenomic-assembly" id="toc-metagenomic-assembly" class="nav-link" data-scroll-target="#metagenomic-assembly">Metagenomic assembly</a></li>
  </ul></li>
  <li><a href="#flye-is-a-long-read-assembler" id="toc-flye-is-a-long-read-assembler" class="nav-link" data-scroll-target="#flye-is-a-long-read-assembler">Flye is a long-read assembler</a>
  <ul class="collapse">
  <li><a href="#running-a-command-in-the-background" id="toc-running-a-command-in-the-background" class="nav-link" data-scroll-target="#running-a-command-in-the-background">Running a command in the background</a></li>
  <li><a href="#checking-progress-jobs" id="toc-checking-progress-jobs" class="nav-link" data-scroll-target="#checking-progress-jobs">Checking progress: <code>jobs</code></a></li>
  <li><a href="#checking-progress-the-log-file" id="toc-checking-progress-the-log-file" class="nav-link" data-scroll-target="#checking-progress-the-log-file">Checking progress: the log file</a></li>
  <li><a href="#determining-if-the-assembly-has-finished" id="toc-determining-if-the-assembly-has-finished" class="nav-link" data-scroll-target="#determining-if-the-assembly-has-finished">Determining if the assembly has finished</a></li>
  <li><a href="#what-is-the-assembly-output" id="toc-what-is-the-assembly-output" class="nav-link" data-scroll-target="#what-is-the-assembly-output">What is the Assembly output?</a></li>
  </ul></li>
  <li><a href="#assembly-statistics" id="toc-assembly-statistics" class="nav-link" data-scroll-target="#assembly-statistics">Assembly Statistics</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Cloud-SPAN/nercMtGn-bashAutomation/edit/main/docs/lesson03-qc-assembly/02-assembly.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/Cloud-SPAN/nercMtGn-bashAutomation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/lesson03-qc-assembly/index.html">QC &amp; Assembly</a></li><li class="breadcrumb-item"><a href="../../docs/lesson03-qc-assembly/02-assembly.html">Metagenome Assembly</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Metagenome Assembly</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<h2 id="important" class="anchored">IMPORTANT</h2>
<p>The analyses in this lesson will take several hours to complete! You can find some recommended reading at the end of the page that you might want to read whilst you’re waiting. {: .callout}</p>
</blockquote>
<section id="assembling-reads" class="level2">
<h2 class="anchored" data-anchor-id="assembling-reads">Assembling reads</h2>
<p><img align="right" width="325" height="316" src="{{ page.root }}/fig/03_short_analysis_flowchart_short_asm.png" alt="Analysis flow diagram that shows the steps: Sequence reads, Quality control and assembly."></p>
<p>In the last episode, we put both the long and short raw reads through quality control. They are now ready to be assembled into a metagenome. Genomic assembly is the process of joining smaller fragments of DNA (<em>i.e.</em>, reads) to make longer segments to try and reconstruct the original genomes.</p>
<p><br clear="right"></p>
<section id="genomic-assembly" class="level3">
<h3 class="anchored" data-anchor-id="genomic-assembly">Genomic assembly</h3>
<p>You can think of Genomic assembly as a jigsaw puzzle: each raw read corresponds to a piece of the puzzle and you are aiming to complete the puzzle by joining these pieces together in the right order.</p>
<p>There are two main strategies for genome assembly: 1. Mapping to a reference genome - requires that there is a complete genome of the organism you have sequenced, or a closely related organism. This is the approach you would take if you were trying to identify variants for well-characterised species, such as humans. 2. <em>De novo</em> assembly - does not use a reference but instead assembles reads together based on the content of the reads (the specific approach depends on which assembly software you are using). It is commonly used for environmental samples which usually contain many organisms that have not been cultured previously.</p>
<p>Continuing the jigsaw analogy, mapping to a reference genome would be equivalent to having an image of the final puzzle to compare your assembly to. In contrast, in <em>de novo</em> assembly you would have to depend entirely on which pieces fit together.</p>
</section>
<section id="metagenomic-assembly" class="level3">
<h3 class="anchored" data-anchor-id="metagenomic-assembly">Metagenomic assembly</h3>
<p>Metagenomic sequencing adds another layer to the challenge of assembly! Instead of having one organism to assemble you now have many! Depending on the complexity of a metagenome you could have anywhere from a handful of organisms in a community to thousands.</p>
<p>You no longer have one jigsaw puzzle, but many with all the pieces mixed together.</p>
<p><img align="center" width="775" height="717" src="{{ page.root }}/fig/03_genomics_v_metagenomics.png" alt="Metagenomic flow diagram with the steps raw reads, assembly and polishing and binning ."></p>
<p>Many of the communities sequenced using metagenomics contain previously uncultured microbes (often known as microbial dark matter) so they are unlikely to have reference genomes. In addition, you don’t usually know what you are sequencing - the community of organisms is unknown.</p>
<p>Assembling our metaphorical jigsaw will be a challenge. We have many, perhaps thousands, of jigsaws to assemble and no pictures</p>
<p>Luckily there are programs, known as assemblers, that will do this for us!</p>
<p>Metagenomic assembly faces additional problems, which means we need an assembler built to handle metagenomes. These additional problems include: 1. Differences in coverage between the genomes, due to differences in abundance across the sample. 2. The fact that different species often share conserved regions. 3. The presence of several strains of a single species in the community</p>
<p>The assembly strategy also differs based on the sequencing technology used to generate the raw reads. Here we’re using raw data from <a href="https://nanoporetech.com/applications/dna-nanopore-sequencing">Nanopore sequencing</a> as the basis for this metagenome assembly so we need to use a metagenome assembler appropriate for long-read sequencing.</p>
<p>We will be using <a href="https://github.com/fenderglass/Flye">Flye</a>, which is a <strong>long-read</strong> <em>de novo</em> assembler for assembling large and complex data with a metagenomic mode. Like all our programs, Flye has been pre-installed onto your instance.</p>
<p><br clear="left"></p>
</section>
</section>
<section id="flye-is-a-long-read-assembler" class="level2">
<h2 class="anchored" data-anchor-id="flye-is-a-long-read-assembler">Flye is a long-read assembler</h2>
<blockquote class="blockquote">
<h2 id="important-1" class="anchored">Important</h2>
<p>Make sure you’re still logged into your cloud instance. If you can’t remember how to log on, visit <a href="../01-QC-quality-raw-reads#getting-started">the instructions from earlier today</a>. {: .callout}</p>
</blockquote>
<p>Navigate to the <code>analysis</code> directory you made in a previous step. ~~~ cd ~ cd cs_course/analysis ~~~ {: .source}</p>
<p>Run the <code>flye</code> command without any arguments to see a short description of its use:</p>
<pre><code> flye</code></pre>
<p>{: .source}</p>
<pre><code>$ flye
usage: flye (--pacbio-raw | --pacbio-corr | --pacbio-hifi | --nano-raw |
      --nano-corr | --nano-hq ) file1 [file_2 ...]
      --out-dir PATH

      [--genome-size SIZE] [--threads int] [--iterations int]
      [--meta] [--polish-target] [--min-overlap SIZE]
      [--keep-haplotypes] [--debug] [--version] [--help]
      [--scaffold] [--resume] [--resume-from] [--stop-after]
      [--read-error float] [--extra-params]
flye: error: the following arguments are required: -o/--out-dir</code></pre>
<p>{: .output}</p>
<p>A full description can be displayed by using the <code>--help</code> flag: ~~~ flye –help ~~~ {: .bash}</p>
<blockquote class="blockquote">
<h2 id="flye-help-documentation" class="anchored"><code>flye</code> help documentation</h2>
<pre><code>usage: flye (--pacbio-raw | --pacbio-corr | --pacbio-hifi | --nano-raw |
       --nano-corr | --nano-hq ) file1 [file_2 ...]
       --out-dir PATH

       [--genome-size SIZE] [--threads int] [--iterations int]
       [--meta] [--polish-target] [--min-overlap SIZE]
       [--keep-haplotypes] [--debug] [--version] [--help]
       [--scaffold] [--resume] [--resume-from] [--stop-after]
       [--read-error float] [--extra-params]

Assembly of long reads with repeat graphs

optional arguments:
  -h, --help            show this help message and exit
  --pacbio-raw path [path ...]
                        PacBio regular CLR reads (&lt;20% error)
  --pacbio-corr path [path ...]
                        PacBio reads that were corrected with other methods (&lt;3% error)
  --pacbio-hifi path [path ...]
                        PacBio HiFi reads (&lt;1% error)
  --nano-raw path [path ...]
                        ONT regular reads, pre-Guppy5 (&lt;20% error)
  --nano-corr path [path ...]
                        ONT reads that were corrected with other methods (&lt;3% error)
  --nano-hq path [path ...]
                        ONT high-quality reads: Guppy5+ or Q20 (&lt;5% error)
  --subassemblies path [path ...]
                        [deprecated] high-quality contigs input
  -g size, --genome-size size
                        estimated genome size (for example, 5m or 2.6g)
  -o path, --out-dir path
                        Output directory
  -t int, --threads int
                        number of parallel threads [1]
  -i int, --iterations int
                        number of polishing iterations [1]
  -m int, --min-overlap int
                        minimum overlap between reads [auto]
  --asm-coverage int    reduced coverage for initial disjointig assembly [not set]
  --hifi-error float    [deprecated] same as --read-error
  --read-error float    adjust parameters for given read error rate (as fraction e.g. 0.03)
  --extra-params extra_params
                        extra configuration parameters list (comma-separated)
  --plasmids            unused (retained for backward compatibility)
  --meta                metagenome / uneven coverage mode
  --keep-haplotypes     do not collapse alternative haplotypes
  --scaffold            enable scaffolding using graph [disabled by default]
  --trestle             [deprecated] enable Trestle [disabled by default]
  --polish-target path  run polisher on the target sequence
  --resume              resume from the last completed stage
  --resume-from stage_name
                        resume from a custom stage
  --stop-after stage_name
                        stop after the specified stage completed
  --debug               enable debug output
  -v, --version         show program's version number and exit

Input reads can be in FASTA or FASTQ format, uncompressed
or compressed with gz. Currently, PacBio (CLR, HiFi, corrected)
and ONT reads (regular, HQ, corrected) are supported. Expected error rates are
&lt;15% for PB CLR/regular ONT; &lt;5% for ONT HQ, &lt;3% for corrected, and &lt;1% for HiFi. Note that Flye
was primarily developed to run on uncorrected reads. You may specify multiple
files with reads (separated by spaces). Mixing different read
types is not yet supported. The --meta option enables the mode
for metagenome/uneven coverage assembly.

To reduce memory consumption for large genome assemblies,
you can use a subset of the longest reads for initial disjointig
assembly by specifying --asm-coverage and --genome-size options. Typically,
40x coverage is enough to produce good disjointigs.

You can run Flye polisher as a standalone tool using
--polish-target option.</code></pre>
<p>{: .output} {: .solution}</p>
</blockquote>
<p>Flye has multiple different options available and we need to work out which ones are appropriate for our dataset.</p>
<p>The most important thing to know is which program was used to basecall our reads, as this determines which of <code>(--pacbio-raw | --pacbio-corr | --pacbio-hifi | --nano-raw | --nano-corr | --nano-hq )</code> we choose. In the <a href="https://environmentalmicrobiome.biomedcentral.com/articles/10.1186/s40793-022-00424-2#Sec2">Methods section of our source paper</a> the authors state that:</p>
<p><img src="{{ page.root }}/fig/methods_guppy_version.png" width="700"></p>
<p>This means we should use the <code>--nano-raw</code> option, as the reads were called with a version of Guppy that precedes v5 (Guppy is a program used to convert the signals that come out of a sequencer into an actual string of bases). This option will be followed by the relative path to the long-read .fastq file.</p>
<p>We also need to choose how many times we want Flye to ‘polish’ the data after assembly. Polishing is a way to improve the accuracy of the assembly. The number of rounds of polishing is specified using <code>-i</code> or <code>--iterations</code>. We will do three rounds of polishing, which is a standard practice (though the default in Flye is one round only).</p>
<p>The other options are a bit easier:</p>
<ul>
<li>We use <code>-o</code> or <code>--outdir</code> to specify (using a relative path) where the Flye output should be stored</li>
<li>We also use the <code>-t</code> or <code>--threads</code> flag in order to run the assembly on multiple threads (aka running several processes at once) in order to speed it up</li>
<li>Finally we indicate that the dataset is a metagenome using the <code>--meta</code> option</li>
</ul>
<blockquote class="blockquote">
<h2 id="unused-parameters" class="anchored">Unused parameters</h2>
<p>There are many parameters that we don’t need. Some of these are deprecated and some are only appropriate for certain types of data. Others are useful to allow tweaking to try to further improve an assembly (e.g.&nbsp;<code>--genome-size</code> and <code>--read-error</code>).</p>
<p>Most bioinformatics programs have an associated website (which is often a GitHub page) with a whole manual to use the program. The <a href="https://github.com/fenderglass/Flye/blob/flye/docs/USAGE.md">Flye Manual</a> contains a lot of further information about the parameters available. If you’re going to try using Flye on your own long-read dataset this is a good place to start.<br>
{: .callout}</p>
</blockquote>
<p>Now we’ve worked out what parameters are appropriate for our data we can put them all together in one command. Since the command is quite long, we will use backward slashes to allow it to span several lines. <code>\</code> basically means “start a new line and carry on reading without submitting the command”.</p>
<p>First let’s make sure we’re in the <code>analysis</code> directory, and make a new directory called <code>assembly</code> for the Flye output. ~~~ cd ~/cs_course/analysis/ mkdir assembly ~~~ {: .bash}</p>
<p>Now we can start constructing our command! You can type/copy this code into your command line but don’t press enter just yet.</p>
<pre><code> flye --nano-raw ~/cs_course/data/nano_fastq/ERR5000342_sub12_filtered.fastq \
     --out-dir assembly \
     --threads 8 \
     --iterations 3 \
     --meta</code></pre>
<p>{: .bash}</p>
<ul>
<li><code>--nano-raw</code> tells Flye that it is receiving pre-Guppy5 reads and that the <strong>input</strong> is found at the path <code>~/cs_course/data/nano_fastq/ERR5000342_sub12_filtered.fastq</code> (note that we are using our ‘filtered reads’ - there’d be no point doing quality control and filtering otherwise!)</li>
<li><code>--out-dir</code> tells Flye that the <strong>output</strong> should be saved in the <code>assembly/</code> directory</li>
<li><code>--threads</code> indicates that the number of parallel cores is <code>8</code></li>
<li><code>--iterations</code> indicates that the data will be polished <code>3</code> times</li>
<li><code>--meta</code> indicates that the dataset is a metagenome</li>
</ul>
<p><strong><span style="color:red"> Don’t run this command yet! If you have, you can press <kbd>Ctrl</kbd>+<kbd>z</kbd> to stop the command.</span></strong></p>
<p>Now we’ve built our command we could stop here <strong>but</strong> metagenomic assembly takes a long time. If we were to run this command as is we’d have to stay logged into the instance (aka leaving your computer running) for hours.</p>
<p>Luckily we don’t have to do that as we’re using a remote computer.</p>
<section id="running-a-command-in-the-background" class="level3">
<h3 class="anchored">Running a command in the background</h3>
<p>All the commands we have run so far have been in the “foreground”, meaning they’ve been run directly in the terminal window, the prompt disappears and we can’t use the terminal again until the command is finished.</p>
<p>Commands can also be run in the “background” so the prompt is returned before the command is finished and we can continue using our terminal. Commands run in the background are often called “jobs”. A major advantage of running a long job in the background is that you can log out of your instance without killing the process.</p>
<blockquote class="blockquote">
<h2 id="warning" class="anchored" data-anchor-id="running-a-command-in-the-background">Warning</h2>
<p>If you run the job in the foreground it will stop as soon as you log out of the instance! Running jobs in the background is your friend! {: .callout}</p>
</blockquote>
<p>To run a command in the background, we follow it with an ampersand (<code>&amp;</code>) symbol.</p>
<p>The final thing to add to our <code>flye</code> command is “redirection”: <code>&amp;&gt; flye_output.txt</code> will send any output that would be sent to the terminal to a file, <code>flye_output.txt</code> instead</p>
<p>The complete command is: ~~~ flye –nano-raw ~/cs_course/data/nano_fastq/ERR5000342_sub12_filtered.fastq<br>
–out-dir assembly<br>
–threads 8<br>
–iterations 3<br>
–meta &amp;&gt; flye_output.txt &amp; ~~~ {: .bash}</p>
<p><code>&amp;&gt;</code> redirects sends information that would normally go to the terminal to a file instead. This means any logging and progress information <code>flye</code> creates will be saved in <code>flye_output.txt</code>. Note the lack of a space between <code>&amp;&gt;</code>. The second <code>&amp;</code> then runs this command in the background.</p>
<p>We can now press enter to run the command. Your prompt should immediately return. This doesn’t mean that the code has finished already: it is now running in the background.</p>
<blockquote class="blockquote">
<h2 id="running-commands-on-different-servers" class="anchored">Running commands on different servers</h2>
<p>There are many different ways to run jobs in the background in a terminal.<br>
How you run these commands will depend on the computing resources (and their fair use policies) you are using The main options include: * <code>&amp;</code>, which we’ve covered here. Depending on the infrastructure you’re running the command on, you may also need to use <a href="https://www.digitalocean.com/community/tutorials/nohup-command-in-linux"><code>nohup</code></a> to prevent the background job from being killed when you close the terminal.<br>
* The command line program <a href="https://linuxize.com/post/how-to-use-linux-screen/"><code>screen</code></a>, which allows you to create a shell session that can be completely detached from a terminal and re-attached when needed. * Queuing system - many shared computing resources, like the High Performance Computing (HPC) clusters owned by some Universities, operate a queuing system (e.g.&nbsp;SLURM or SGE) so each user gets their fair share of computing resources. With these you submit your command / job to the queueing system, which will then handle when to run the job on the resources available. {: .callout}</p>
</blockquote>
<p>As we’re running the command in the background we no longer see the output on the terminal but we can still check on the progress of the assembly. There are two options to do this.</p>
<ol type="1">
<li>Using the command <code>jobs</code> to view what is running</li>
<li>Examining the log file created by <code>flye</code> using <code>less</code></li>
</ol>
</section>
<section id="checking-progress-jobs" class="level3">
<h3 class="anchored" data-anchor-id="checking-progress-jobs">Checking progress: <code>jobs</code></h3>
<p>Jobs command is used to list the jobs that you are running in the background and in the foreground. If the prompt is returned with no information no commands are being run. ~~~ jobs ~~~ {: .bash} ~~~ [1]+ Running flye –nano-raw ~/cs_course/data/nano_fastq/ERR5000342_sub12_filtered.fastq –out-dir assembly –threads 8 –iterations 3 –meta &amp;&gt; flye_output.txt &amp; ~~~ {: .output}</p>
<p>The <code>[1]</code> is the job number. If you need to stop the job running, you can use <code>kill %1</code>, where 1 is the job number.</p>
</section>
<section id="checking-progress-the-log-file" class="level3">
<h3 class="anchored">Checking progress: the log file</h3>
<p>Flye generates a log file when running, which is stored in the output folder it has generated. Using <code>less</code> we can navigate through this file. ~~~ less assembly/flye.log ~~~ {: .bash}</p>
<p>The contents of the file will depend on how far through the assembly Flye is. At the start of an assembly you’ll probably see something like this: ~~~ [2022-10-05 17:22:03] INFO: Starting Flye 2.9.1-b1780 [2022-10-05 17:22:03] INFO: &gt;&gt;&gt;STAGE: configure [2022-10-05 17:22:03] INFO: Configuring run [2022-10-05 17:22:17] INFO: Total read length: 3023658929 [2022-10-05 17:22:17] INFO: Reads N50/N90: 5389 / 2607 [2022-10-05 17:22:17] INFO: Minimum overlap set to 3000 [2022-10-05 17:22:17] INFO: &gt;&gt;&gt;STAGE: assembly ~~~ {: .output}</p>
<p>Different steps in the assembly process take different amounts of time so it might appear stuck. However, it is almost certainly still running if it was run in the background.</p>
<p>Note: this log file will contain data similar to the data in the <code>flye_output.txt</code> file we’re generating when redirecting the terminal output. But it’s easier to look at the log file as flye will always generate that even if you’re running the command differently (e.g.&nbsp;in the foreground).</p>
<blockquote class="blockquote">
<h2 id="navigation-commands-in-less" class="anchored" data-anchor-id="checking-progress-the-log-file">Navigation commands in <code>less</code>:</h2>
<table class="table">
<thead>
<tr class="header">
<th>key</th>
<th>action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><kbd>Space</kbd></td>
<td>to go forward</td>
</tr>
<tr class="even">
<td><kbd>b</kbd></td>
<td>to go backward</td>
</tr>
<tr class="odd">
<td><kbd>g</kbd></td>
<td>to go to the beginning</td>
</tr>
<tr class="even">
<td><kbd>G</kbd></td>
<td>to go to the end</td>
</tr>
<tr class="odd">
<td><kbd>q</kbd></td>
<td>to quit</td>
</tr>
</tbody>
</table>
<p>See <a href="https://cloud-span.github.io/prenomics02-command-line/02-working-with-file/index.html">Prenomics - Working with Files and Directories</a> for a full overview on using <code>less</code>. {: .callout}</p>
</blockquote>
<p>Flye is likely to take <strong>up to 5 hours</strong> to finish assembling - so feel free to leave this running overnight and come back to it tomorrow. You don’t need to remain connected to the instance during this time (and you can turn your computer off!) but once you have disconnected from the instance it does mean you can no longer use <code>jobs</code> to track the job.</p>
<p>In the meantime, if you wanted to read more about assembly and metagenomics there’s a few papers and resources at the end with recommended reading.</p>
</section>
<section id="determining-if-the-assembly-has-finished" class="level3">
<h3 class="anchored" data-anchor-id="determining-if-the-assembly-has-finished">Determining if the assembly has finished</h3>
<p>After leaving it several hours, Flye should have finished assembling.</p>
<p>If you remained connected to the instance during the process you will be able to tell it has finished because you get the following output in your terminal when the command has finished.</p>
<pre><code>[2]+  Done      flye --nano-raw ~/cs_course/data/nano_fastq/ERR5000342_sub12_filtered.fastq --out-dir assembly --threads 8 --iterations 3 --meta &amp;&gt; flye_output.txt &amp;</code></pre>
<p>{: .output}</p>
<p>This message won’t be displayed if you disconnected from the instance for whatever reason during the assembly process. However, you can still examine the <code>flye.log</code> file in the <code>assembly</code> directory. If the assembly has finished the log file will have summary statistics and information about the location of the assembly at the end.</p>
<p>Move to the <code>assembly</code> directory and use <code>less</code> to examine the contents of the log file: ~~~ cd ~/cs_course/analysis/assembly/ less flye.log ~~~ {: .bash}</p>
<p>Navigate to the end of the file using <kbd>G</kbd>. You should see something like: ~~~ [2023-02-24 14:41:27] root: INFO: Assembly statistics:</p>
<pre><code>    Total length:   18872828
    Fragments:      1161
    Fragments N50:  20921
    Largest frg:    118427
    Scaffolds:      0
    Mean coverage:  7</code></pre>
<p>[2023-02-24 14:41:27] root: INFO: Final assembly: /home/csuser/cs_course/analysis/assembly/assembly.fasta ~~~ {: .output}</p>
<p>There are some basic statistics about the final assembly created.</p>
</section>
<section id="what-is-the-assembly-output" class="level3">
<h3 class="anchored">What is the Assembly output?</h3>
<p>If we use <code>ls</code> in the <code>assembly</code> directory we can see the that Flye has created many different files.</p>
<pre><code>00-assembly   20-repeat     40-polishing    assembly_graph.gfa  assembly_info.txt  params.json
10-consensus  30-contigger  assembly.fasta  assembly_graph.gv   flye.log</code></pre>
<p>{: .output}</p>
<p>One of these is <code>flye.log</code> which we have already looked at.</p>
<ul>
<li>Flye generates a directory to contain the output for each step of the assembly process. (These are the <code>00-assembly</code>, <code>10-consensus</code>, <code>20-repeat</code>, <code>30-contigger</code> and <code>40-polishing</code> directories.)<br>
</li>
<li>We also have a file containing the parameters we ran the assembly under <code>params.json</code> which is useful to keep our analysis reproducible.<br>
</li>
<li>The assembled contigs are in FASTA format (<code>assembly.fasta</code>), a common standard file type for storing sequence data without its quality scores.<br>
</li>
<li>There’s a text file which contains more information about each contig created (<code>assembly_info.txt</code>).</li>
<li>Finally we have two files for a repeat graph (<code>assembly_graph.gfa</code> or <code>assembly_graph.gv</code>) which is a visual way to view the assembly.</li>
</ul>
<p>You can see more about the output for Flye in the <a href="https://github.com/fenderglass/Flye/blob/flye/docs/USAGE.md#output">documentation on GitHub</a>.</p>
<blockquote class="blockquote">
<h2 id="contigs-vs.-reads" class="anchored" data-anchor-id="what-is-the-assembly-output">Contigs vs.&nbsp;reads</h2>
<p>We have seen reads in the raw sequencing data - these are our individual jigsaw pieces.</p>
<p>Contigs (from the word <em>contiguous</em>) are longer fragments of DNA produced after raw reads are joined together by the assembly process. These are like the chunks of the jigsaw puzzle the assembler has managed to complete. Contigs are usually much longer than raw reads but vary in length and number depending on how successful the assembly has been.<br>
{: .callout}</p>
</blockquote>
</section>
</section>
<section id="assembly-statistics" class="level2">
<h2 class="anchored" data-anchor-id="assembly-statistics">Assembly Statistics</h2>
<p>Flye gave us basic statistics about the size of the assembly but not all assemblers do. We can use <a href="https://bioinf.shenwei.me/seqkit/">Seqkit</a> to calculate summary statistics from the assembly. We previously used another <code>Seqkit</code> command, <code>seq</code> to Filter our Nanopore sequences by quality. This time we will use the command <code>stats</code>.</p>
<p>Make sure you are in the <code>assembly</code> folder then run <code>seqkit stats</code> on <code>assembly.fasta</code>: ~~~ cd ~/cs_course/analysis/assembly/ seqkit stats assembly.fasta ~~~ {: .bash}</p>
<p><code>SeqKit</code> is fast so we have run the command in the terminal foreground. It should take just a couple of seconds to process this assembly. Assemblies with more sequencing data can take a bit longer.</p>
<p>Once it has finished you should see an output table like this: ~~~ file format type num_seqs sum_len min_len avg_len max_len assembly.fasta FASTA DNA 790 11,957,486 511 15,136.1 95,862</p>
<p>~~~ {: .output}</p>
<p>This table shows the input file, the format of the file, the type of sequence and other statistics. The assembly process introduces small random variations in the assemly so your table will likely differ slightly. However, you should expect the numbers to be very similar.</p>
<p>Using this table of statistics, answer the questions below.</p>
<blockquote class="blockquote">
<h2 id="exercise-1-looking-at-basic-statistics" class="anchored">Exercise 1: Looking at basic statistics</h2>
<p>Using the output for seqkit stats above, answer the following questions.</p>
<ol type="a">
<li>How many contigs are in this assembly?<br>
</li>
<li>How many bases in total have been assembled?<br>
</li>
<li>What is the shortest and longest contig produced by this assembly?<br>
&gt; ## Solution &gt; From our table:<br>
&gt; a) From <code>num_seqs</code> we can see that this assembly is made up of 790 contigs<br>
&gt; b) Looking at <code>sum_length</code> we can see that the assembly is 11,957,486bp in total (over 11 million bp!)<br>
&gt; c) From <code>min_length</code> we can see the shortest contig is 511p and from <code>max_length</code> the longest contig is 95,862bp<br>
{: .solution} {: .challenge}</li>
</ol>
</blockquote>
<blockquote class="blockquote">
<h2 id="recommended-reading" class="anchored">Recommended reading:</h2>
<p>While you’re waiting for the assembly to finish here are some things you might want to read about: * An overall background to the history of DNA sequencing in <a href="https://www.nature.com/articles/nature24286">DNA sequencing at 40: past, present and future</a><br>
* An overview of a metagenomics project <a href="https://www.nature.com/articles/nbt.3935">Shotgun metagenomics, from sampling to analysis</a> - though note this paper is from 2017 so some techniques and software will be different now.<br>
* The challenges of genomic and metagenomic assembly and the algorithms that have been built to overcome these in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2874646/">Assembly Algorithms for Next-Generation Sequencing Data</a><br>
* The approach Flye uses to assemble metagenomes is covered in <a href="https://www.nature.com/articles/s41592-020-00971-x">metaFlye: scalable long-read metagenome assembly using repeat graphs</a> * Comparison of genome assembly for bacteria <a href="https://www.mdpi.com/1422-0067/22/14/7668/htm">Comparison of De Novo Assembly Strategies for Bacterial Genomes</a> * Benchmarking of assemblers including flye in prokaryotes <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6966772/">Benchmarking of long-read assemblers for prokaryote whole genome sequencing</a> * Comparison of combined assembly and polishing method <a href="https://link.springer.com/article/10.1186/s13059-021-02483-z">Trycycler: consensus long-read assemblies for bacterial genomes</a> * Using nanopore to produce ultra long reads and contiguous assemblies <a href="https://www.nature.com/articles/nbt.4060">Nanopore sequencing and assembly of a human genome with ultra-long reads</a> {: .callout}</p>
</blockquote>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/Cloud-SPAN\.github\.io\/nercMtGn-bashAutomation\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../docs/lesson03-qc-assembly/01-QC-quality-raw-reads.html" class="pagination-link" aria-label="Assessing Read Quality, Trimming and Filtering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assessing Read Quality, Trimming and Filtering</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../docs/lesson04-polishing/index.html" class="pagination-link" aria-label="Polishing">
        <span class="nav-page-text">Polishing</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2021–24 by <a href="https://cloud-span.york.ac.uk/">Cloud-SPAN</a></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../about.qmd">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../docs/faq/index.qmd">
<p>FAQ</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license.qmd">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../trademark.qmd">
<p>Trademark</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Cloud-SPAN/nercMtGn-bashAutomation/edit/main/docs/lesson03-qc-assembly/02-assembly.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/Cloud-SPAN/nercMtGn-bashAutomation/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/quarto_pub">
      <i class="bi bi-twitter" role="img" aria-label="Quarto Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/quarto-dev/quarto-cli">
      <i class="bi bi-github" role="img" aria-label="Quarto GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://quarto.org/docs/blog/index.xml">
      <i class="bi bi-rss" role="img" aria-label="Quarto Blog RSS">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>